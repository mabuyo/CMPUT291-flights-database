select flightno1, flightno2, src, dst, dep_time, arr_time, layover, numStops, fare1, fare2, price, SUM(seats) as seatsLeft from (select flightno1, flightno2, src, dst, dep_time, arr_time, layover, 1 numStops, fare1, fare2, price, seats from good_connections where to_char(dep_date,'DD/MM/YYYY')='22/12/2015' and src='YEG' and dst='LAX' union select flightno, '' flightno2, src, dst, dep_time, arr_time, 0  layover, 0 numStops, fare, '' fare2, price, seats from available_flights where to_char(dep_date,'DD/MM/YYYY')='22/12/2015' and src='YEG' and dst='LAX') GROUP BY flightno1, flightno2, src, dst, dep_time, arr_time, layover, numStops, fare1, fare2, price HAVING SUM(SEATS) >= 1  ORDER BY NUMSTOPS ASC, PRICE ASC;

SELECT flightno1, flightno2, src, dst, dep_time, arr_time, layover, numStops, fare1, fare2, price, SUM(seats) FROM (select flightno1, flightno2, src, dst, dep_time, arr_time, layover, numStops, fare1, fare2, price, seats from (select flightno1, flightno2, src, dst, dep_time, arr_time, layover, 1 numStops, fare1, fare2, price, seats from good_connections where to_char(dep_date,'DD/MM/YYYY')='22/12/2015' and src='YEG' and dst='LAX' union select flightno, '' flightno2, src, dst, dep_time, arr_time, 0  layover, 0 numStops, fare, '' fare2, price, seats from available_flights where to_char(dep_date,'DD/MM/YYYY')='22/12/2015' and src='YEG' and dst='LAX')) GROUPBY flightno1, flightno2, price ORDER BY PRICE; 
